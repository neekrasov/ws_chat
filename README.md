# Websocket чат

## Технические детали
Технологии: `Python/asyncio`, `FastAPI`, `Redis`, `MongoDB/beanie/motor`, `Docker/docker-compose`, `Jinja2`, `Websockets`, `FastAPI-Users`.

Все вызовы являются асинхронными.  
В качестве брокера сообщений, и хранилища auth токенов выступает `redis`.  
Передача сообщений происходит в отдельном потоке `redis'a`.

### Цель
 - Изучить взаимодействие `FastAPI` и `Websockets`.
 - Изучить взаимодействие `WebSockets` и `Redis`.

### Описание
Приложение представляет собой чат, в котором пользователи могут общаться в режиме реального времени.

### Реализовано
- [x] Простой пользователький интерфейс.
- [x] Регистрация и авторизация пользователей.
- [x] Создание комнат.
- [x] Приглашение пользователей в комнаты.
- [x] Отправка сообщений в комнатах.
- [x] Просмотр списка доступных комнат.
- [x] Уведомление о присоединении пользователя в комнату.
- [x] Уведомление о выходе пользователя из комнаты.

### API Endpoints (взаимодействие с чатом)
`GET /` - Главная страница.  
`POST /api/v1/chat/create` - Создание комнаты.  
`POST /api/v1/chat/add-user` - Приглашение пользователя в комнату.  
`GET /api/v1/chat/get-my` - Получение списка чатов пользователя.  
`GET /api/v1/chat/history/{room_id}` - Получение истории сообщений в комнате.  
`WS /api/v1/chat/ws?data_token={encrypt-info}` - Websocket для обмена сообщениями.  
Ручки по CRUD пользователей, и авторизации не описываю, т.к. они реализованы в `FastAPI-Users`.

### Развёртывание
1. Клонировать репозиторий.

```
~$ git clone https://github.com/neekrasov/ws_chat.git
```

2. Создать файл dev.env на примере example.env .
```
ws_chat$ cp example.env dev.env
```

3. Поднять контейнеры.
```
ws_chat$ docker compose up
```
4. Открыть в браузере http://localhost:8000 или http://localhost:8000/api/docs.

### Дополнительно
Документация в json формате представлена по адресу http://localhost:8000/api/openapi.json.

